# Joomla

Joomla helps to develop a website very easily. Joomla can be easily installed, handled and managed. When discussing Joomla security, we must take into account both the Joomla framework and its extensions. If you check the Joomla security Centre, you will find the list of all latest vulnerabilities related to all versions (https://developer.joomla.org/security-centre.html). If you check closely, it is clear that joomla itself is quite stable and less probe to attack.  Most of the time, only some XSS, SQL, LFI, etc. will be identified in the
core which are already fixed and patched.


## Joomla Extension 

One of the most common reasons for Joomla sites being compromised is vulnerable extensions, modules & plugins.  To give it a start, you can look forward to https://extensions.joomla.org/vulnerable-extensions/about/ . 


## Exploiting Joomla (Manual)


1.	Identify the Joomla version. ( Check for unnecessary files like ; Joomla.xml, readme.txt,– These kinds of files store a good amount of information within them and can be of great use in identifying whether a site is using Joomla or not.). Locating the administrator page will give you an idea of CMS.

2.	Check out the robots.txt.

3.	Look for the administrative page. Try brute force on Joomla administrator page. 


4.	Once you identify the Joomla version, you can go to exploit-db.com, Packet Storm Security , CVE database  and search for Joomla vulnerabilities listed there. 

5.	Look for the user input field, so that we can pass malicious inputs.

6.	Look at the URL parameters. Analyze each parameter and try SQLI, XSS attacks.

7.	Test for SQL injection. The most common and popular method to hack a Joomla site is to find a SQL injection flaw and exploit the same. Look at the URL parameters. Analyze each parameter and try SQLI.

8.	Test for local file inclusion attack. Most of the Joomla installations are vulnerable for this type of attack and some of them don’t even get fixed. Identify the vulnerable parameter and try directory traversal. Directory traversal can be used to steal credentials. 

9.	Test for XSS . The most common and popular method to hack a Joomla site is to find a XSS flaw and exploit the same. Look at the URL parameters. Analyze each parameter and try XSS.

10.	Look for content discovery. Look for sensitive information, database credentials, backups, are just a few items that can be found with content discovery. Content discovery is attempting to find any interesting items contained within a web path of an application.  If the administrator left the backup of the folder in the publicly accessible web root, it will allow the attacker to access all the files. Check for /phpinfo.php file, which helps the attacker to know the php versions and many other server information.

11.	Test for privilege escalation vulnerability. The privilege escalation vulnerability has been deemed as a critical vulnerability in Joomla versions 3.4.4 through 3.6.3. In this, a module creates an arbitrary account with administrative privileges. Thereafter, an e-mail is sent to activate the account, if an email server is configured in the CMS.

12.	Test for remote file inclusion.

13.	Test for SSL configuration. SSLScan tool queries SSL services, such as HTTPS, in order to determine the ciphers that are supported. SSLScan is designed to be easy, lean and fast. The output includes preferred ciphers of the SSL service, the certificate and is in text and XML formats. 

14.	Test for security header configuration. shcheck tool helps to check which security headers are enabled on certain websites.

## Exploiting Joomla (Automatic)

### CMS explorer 
It is an automated tool used to figure  and  understand the different modules, plugins, components and themes a particular CMS based site is using. It has ability
to reveal hidden/library files which are not typically accessed by web clients.
Example: The usage of CMS Explorer.
$ ./cms-explorer.pl –url <your_target_site> -type Joomla

### Joomscan 
It is an automated tool capable of identifying the joomla version and of identifying the vulnerabilities related to the joomla version used. It can be used to identify the hidden files.
Example: The usage of joomsca.
joomscan --url <your_target_site>
Joomscan --help can be used to explore more.

![joomsca](https://github.com/amalrajpc/Pentesing-CMS-Based-Sites/assets/102909507/959338b0-cec6-4027-80dd-7ccdc479a860)

### Nmap http-Joomla-brute script
This script can be used to brute force on Joomla administrator login panel. It reads the session cookie and parses the security token to brute force password auditing.

![nmap_brute](https://github.com/amalrajpc/Pentesing-CMS-Based-Sites/assets/102909507/af03ab4d-ad9d-4c70-9595-90ce865b7731)

### SQLmap 
It is an open penetration testing tool which automates the process of finding and exploiting SQL injection flaws and compromising of database servers.

![sqlmap](https://github.com/amalrajpc/Pentesing-CMS-Based-Sites/assets/102909507/23dace6c-b9bf-46b2-81ca-8cdae24b0efd)

### Burpsuite: 
Burp Suite is an integrated platform and graphical tool for performing security testing of web applications, it supports the entire testing process, from initial mapping and analysis of an application's attack surface, through to finding and exploiting security vulnerabilities. The burpsuite support awesome extensions, that helps to fasten your security audit process (https://github.com/snoopysecurity/awesome-burp-extensions).

### JoomlaVS: 
JoomlaVS is an Open source Ruby application. Scan for vulnerabilities in components, modules and templates and basic fingerprinting. More info available on the projects at https://github.com/rastating/joomlavs

### Metasploit: 
Metasploit is an exploitation framework which can be used to exploit web apps, such as CMSes like WordPress, Joomla etc. 

### sslscan: 
SSLScan queries SSL services, such as HTTPS, in order to determine the ciphers that are supported. SSLScan is designed to be easy, lean and fast. The output includes preferred ciphers of the SSL service, the certificate and is in text and XML formats. 
(https://www.kali.org/tools/sslscan/)

![sslscan](https://github.com/amalrajpc/Pentesing-CMS-Based-Sites/assets/102909507/ea23dac8-1626-47c8-93f4-83fcd48d8a9b)


### XSSer: 
XSSer can not only find but actively exploit XSS vulnerabilities. For more help type: ‘xsser --help’.

### Shcheck: 
This tool helps  to check which security headers are enabled on certain websites. https://github.com/santoru/shcheck


## Reference 

  https://www.exploit-db.com
  https://developer.joomla.org/security-centre.html
  https://packetstormsecurity.com/
  https://www.hostinger.com/
  https://hackertarget.com/attacking-enumerating-joomla/
  https://hackertarget.com/sqlmap-post-request-injection/


